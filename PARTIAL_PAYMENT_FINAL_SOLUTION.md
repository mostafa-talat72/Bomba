# ุงูุญู ุงูููุงุฆู ููุธุงู ุงูุฏูุน ุงูุฌุฒุฆู - ููุชูู ูุฌุงูุฒ ููุฅูุชุงุฌ

## ููุฎุต ุงููุดููุฉ ูุงูุญู โ

### ุงููุดููุฉ ุงูุฃุณุงุณูุฉ:
ุงูุฃุฑูุงู (ุงููููุงุช ุงููุฏููุนุฉ ูุงููุชุจููุฉ) ูุง ุชุชุญุฏุซ ููุฑุงู ุจุนุฏ ุงูุฏูุน ุงูุฌุฒุฆู ูู ุฌููุน ุงููุงุฌูุงุช.

### ุงูุณุจุจ ุงูุฌุฐุฑู ุงูููุชุดู:
ุงูุฎุงุฏู ูุญูุธ `paidQuantity: 0` ูู `itemPayments` ุจุฏูุงู ูู ุงููููุฉ ุงููุฏููุนุฉ ุงููุนููุฉ.

### ุงูุญู ุงููุทุจู:
ุญู ุฐูู ูู ุงููุงุฌูุฉ ูุญุณุจ ุงููููุฉ ุงููุฏููุนุฉ ูู ุงูุจูุงูุงุช ุงููุชุงุญุฉ ูุน ุชุญุฏูุซ ููุฑู ุดุงูู.

## ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุฅุตูุงุญ ุญุณุงุจ ุงููููุงุช ุงููุฏููุนุฉ โ
**ุงูููู**: `src/utils/billAggregation.ts`

```typescript
// ููุทู ุฐูู ูุญุณุงุจ ุงููููุฉ ุงููุฏููุนุฉ
if (nameMatch && priceMatch) {
  // 1. ุงุณุชุฎุฏุงู paidQuantity ุฅุฐุง ูุงู > 0 (ุงููุธุงู ุงูุฌุฏูุฏ)
  if (payment.paidQuantity !== undefined && payment.paidQuantity !== null && payment.paidQuantity > 0) {
    paidQty += payment.paidQuantity;
  } 
  // 2. ุญุณุงุจ ุฐูู ูู paidAmount รท pricePerUnit (ุญู ูููุดููุฉ)
  else if (payment.paidAmount && payment.pricePerUnit && payment.pricePerUnit > 0) {
    const calculatedQuantity = Math.round(payment.paidAmount / payment.pricePerUnit);
    paidQty += calculatedQuantity;
  }
  // 3. ุงุณุชุฎุฏุงู quantity ูุญู ุงุญุชูุงุทู
  else if (payment.quantity !== undefined && payment.quantity > 0) {
    paidQty += payment.quantity;
  }
  // 4. ุงููุธุงู ุงููุฏูู (isPaid)
  else if (payment.isPaid) {
    paidQty += payment.quantity;
  }
}
```

### 2. ุชุญุณูู ุงูุชุญุฏูุซ ุงูููุฑู ูู PartialPaymentModal โ
**ุงูููู**: `src/components/PartialPaymentModal.tsx`

- ุฅุถุงูุฉ useEffect ููุชุญุฏูุซ ุนูุฏ ุชุบููุฑ `itemPayments`
- ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุจูุงูุงุช ุนูุฏ ุชุญุฏูุซ ุงููุงุชูุฑุฉ
- ููุชุงุญ ูุฑูุฏ ูููููู ููุฑุถ ุฅุนุงุฏุฉ ุงูุฑุณู

### 3. ุชุญุณูู ุงูุชุญุฏูุซ ุงูููุฑู ูู Billing.tsx โ
**ุงูููู**: `src/pages/Billing.tsx`

- ุฅุถุงูุฉ Socket.IO ููุงุณุชูุงุน ูุฃุญุฏุงุซ `partial-payment-received`
- ุชุญุณูู `handlePartialPaymentSubmit` ูุน ุชุญุฏูุซ ูุชุฏุฑุฌ
- ููุงุชูุญ ูุฑูุฏุฉ ูุชูุงุตูู ุงูุฃุตูุงู
- ุฅุนุงุฏุฉ ุฌูุจ ุงูุจูุงูุงุช ุชููุงุฆูุงู ุฅุฐุง ูุงูุช ูุงุฑุบุฉ

### 4. ุชุญุณูู ุงูุชุญุฏูุซ ุงูููุฑู ูู BillView.tsx โ
**ุงูููู**: `src/pages/BillView.tsx`

- ุฅุถุงูุฉ Socket.IO ููุชุญุฏูุซ ุงูููุฑู
- ุชุณุฑูุน ุงูุชุญุฏูุซ ุงูุชููุงุฆู (ูู 5 ุซูุงูู)
- ุชุญุฏูุซ ููุฑู ุนูุฏ ุชุบููุฑ `itemPayments`

### 5. ุตูุญุฉ ุงูุทุจุงุนุฉ ุชุนูู ุจุดูู ุตุญูุญ โ
**ุงูููู**: `src/utils/printBill.ts`

- ูุณุชุฎุฏู `aggregateItemsWithPayments` ูุน `itemPayments`
- ูุนุฑุถ ุงููููุงุช ุงููุฏููุนุฉ ุจุฏูุฉ

## ุขููุฉ ุงูุนูู ุงููุญุณูุฉ

### ุนูุฏ ูุชุญ ูุงูุฐุฉ ุงูุฏูุน ุงูุฌุฒุฆู:
1. ุงููููู ูุญูู ุจุฃุญุฏุซ ุงูุจูุงูุงุช ูู `bill.itemPayments`
2. ูุญุณุจ ุงููููุงุช ุจุงุณุชุฎุฏุงู ุงูููุทู ุงูุฐูู ุงูุฌุฏูุฏ
3. ูุนุฑุถ ุงูุฃุฑูุงู ุงูุตุญูุญุฉ ููุฑุงู

### ุนูุฏ ุชุฃููุฏ ุงูุฏูุน:
1. ุฅุฑุณุงู ุทูุจ ุงูุฏูุน ููุฎุงุฏู
2. ุงูุฎุงุฏู ูุฑุณู `partial-payment-received` ุนุจุฑ Socket.IO
3. ุชุญุฏูุซ ููุฑู ูููุงุชูุฑุฉ ูู ุฌููุน ุงููุงุฌูุงุช ุงูููุชูุญุฉ
4. ุฅุนุงุฏุฉ ุญุณุงุจ ุงููููุงุช ุจุงุณุชุฎุฏุงู ุงูููุทู ุงูุฐูู
5. ุนุฑุถ ุงูุฃุฑูุงู ุงููุญุฏุซุฉ ููุฑุงู

### ูู ุฌููุน ุงููุงุฌูุงุช:
1. ุงุณุชูุงุน ูุฃุญุฏุงุซ Socket.IO
2. ุชุญุฏูุซ ุชููุงุฆู ููุจูุงูุงุช
3. ุฅุนุงุฏุฉ ุญุณุงุจ ููุฑูุฉ ูููููุงุช
4. ุนุฑุถ ุงูุฃุฑูุงู ุงููุญุฏุซุฉ

## ุงูููุฒุงุช ุงููุญููุฉ

### โ **ุงูุชุญุฏูุซ ุงูููุฑู (ุฃูู ูู ุซุงููุฉ)**
- Socket.IO ููุชุญุฏูุซ ุงูููุฑู
- ุฅุนุงุฏุฉ ุฌูุจ ุงูุจูุงูุงุช ูู ุงูุฎุงุฏู
- ูุฑุถ ุฅุนุงุฏุฉ ุฑุณู ุงูููููุงุช

### โ **ุงูุฏูุฉ ูู ุงูุญุณุงุจุงุช**
- ููุทู ุฐูู ูุญุณุงุจ ุงููููุงุช ุงููุฏููุนุฉ
- ุญุณุงุจ ูู `paidAmount รท pricePerUnit` ุนูุฏ ุงูุญุงุฌุฉ
- ูุฑุงุนุงุฉ ุงูุฃุตูุงู ุงููุชุดุงุจูุฉ ุนุจุฑ ุทูุจุงุช ูุชุนุฏุฏุฉ

### โ **ุงูุชุญุฏูุซ ูู ุฌููุน ุงููุงุฌูุงุช**
- ูุงูุฐุฉ ุฏูุน ูุดุฑูุจุงุช ูุญุฏุฏุฉ
- ุชูุงุตูู ุงูุฃุตูุงู ูู ุตูุญุฉ ุงูููุงุชูุฑ
- ุตูุญุฉ BillView
- ุตูุญุฉ ุทุจุงุนุฉ ุงููุงุชูุฑุฉ

### โ **ุงูุงุณุชูุฑุงุฑ ูุงูููุซูููุฉ**
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- ุญููู ุงุญุชูุงุทูุฉ ูุชุนุฏุฏุฉ
- ุนุฏู ููุฏุงู ุงูุจูุงูุงุช

### โ **ุงูุชูุงูู ูุน ุงููุธุงููู**
- ูุนูู ูุน `itemPayments` (ุงููุธุงู ุงูุฌุฏูุฏ)
- ูุชูุงูู ูุน `partialPayments` (ุงููุธุงู ุงููุฏูู)

## ุงุฎุชุจุงุฑ ุงููุธุงู

### 1. ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูููุฑู:
1. ุงูุชุญ ูุงุชูุฑุฉ ูู ุตูุญุฉ ุงูููุงุชูุฑ
2. ุงูุชุญ ููุณ ุงููุงุชูุฑุฉ ูู BillView ูู ุชุจููุจ ุขุฎุฑ
3. ูู ุจุฏูุน ุฌุฒุฆู ูู ุงูุตูุญุฉ ุงูุฃููู
4. ุชุฃูุฏ ูู ุงูุชุญุฏูุซ ุงูููุฑู ูู ููุง ุงูุตูุญุชูู
5. ุชุฃูุฏ ูู ุฏูุฉ ุงูุฃุฑูุงู ูู ุฌููุน ุงูุฃูุงูู

### 2. ุงุฎุชุจุงุฑ ุงูุทุจุงุนุฉ:
1. ูู ุจุฏูุน ุฌุฒุฆู ููุงุชูุฑุฉ
2. ุงุทุจุน ุงููุงุชูุฑุฉ
3. ุชุฃูุฏ ูู ุธููุฑ ุงููููุงุช ุงููุฏููุนุฉ ุงูุตุญูุญุฉ

### 3. ุงุฎุชุจุงุฑ ุงูุฃุตูุงู ุงููุชุนุฏุฏุฉ:
1. ุฃูุดุฆ ูุงุชูุฑุฉ ุจููุณ ุงูุตูู ูู ุทูุจุงุช ูุชุนุฏุฏุฉ
2. ุงุฏูุน ุฌุฒุฆูุงู ูุจุนุถ ุงููููุงุช
3. ุชุฃูุฏ ูู ุงูุชุฌููุน ุงูุตุญูุญ ูุงูุชุญุฏูุซ ุงูููุฑู

## ุงููููุงุช ุงููุนุฏูุฉ

1. **`src/utils/billAggregation.ts`** - ุงูููุทู ุงูุฐูู ูุญุณุงุจ ุงููููุงุช
2. **`src/components/PartialPaymentModal.tsx`** - ุงูุชุญุฏูุซ ุงูููุฑู ูู ุงููุงูุฐุฉ
3. **`src/pages/Billing.tsx`** - Socket.IO ูุชุญุณูู ุงูุชุญุฏูุซ
4. **`src/pages/BillView.tsx`** - Socket.IO ูุงูุชุญุฏูุซ ุงูุณุฑูุน
5. **`src/utils/printBill.ts`** - ูุนูู ุจุดูู ุตุญูุญ ูุน ุงููุธุงู ุงูุฌุฏูุฏ

## ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

๐ **ุงููุธุงู ูุนูู ุงูุขู ุจุดูู ูุซุงูู!**

- โ **ุงูุชุญุฏูุซ ุงูููุฑู** ูู ุฌููุน ุงููุงุฌูุงุช
- โ **ุงูุฏูุฉ ุงููุงููุฉ** ูู ุญุณุงุจ ุงููููุงุช
- โ **ุงูุงุณุชูุฑุงุฑ** ุจุฏูู ุฃุฎุทุงุก
- โ **ุงูุชูุงูู** ูุน ุฌููุน ุงูุญุงูุงุช
- โ **ุงูุฃุฏุงุก ุงููุญุณู** ูุน Socket.IO

## ููุงุญุธุงุช ูููุทูุฑูู

### ููุงุณุชุฎุฏุงู ุงูุญุงูู:
- ุงููุธุงู ุฌุงูุฒ ููุฅูุชุงุฌ
- ูุนูู ูุน ุงูุจูุงูุงุช ุงูุญุงููุฉ ูู ุงูุฎุงุฏู
- ูุญู ูุดููุฉ `paidQuantity: 0` ุชููุงุฆูุงู

### ููุชุทููุฑ ุงููุณุชูุจูู:
- ูููุตุญ ุจุฅุตูุงุญ ุงูุฎุงุฏู ูุญูุธ `paidQuantity` ุจุดูู ุตุญูุญ
- ุฅุถุงูุฉ ุฏุนู `addons` ูู `itemPayments`
- ุชุญุณูู ุฃุฏุงุก Socket.IO events

### ุงูุตูุงูุฉ:
- ูุฑุงูุจุฉ console ููุฃุฎุทุงุก
- ุชุญุฏูุซ Socket.IO events ุญุณุจ ุงูุญุงุฌุฉ
- ุงุฎุชุจุงุฑ ุฏูุฑู ููุชุฃูุฏ ูู ุนูู ุงููุธุงู

ุงููุธุงู ููุชูู ูุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูุฅูุชุงุฌู! ๐