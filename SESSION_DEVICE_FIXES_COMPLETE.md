# ุฅุตูุงุญ ูุดุงูู ุงูุฃุฌูุฒุฉ ูุงูุฌูุณุงุช - ููุชูู

## ููุฎุต ุงููุดุงูู ูุงูุญููู

### โ **ุงููุดููุฉ ุงูุฃููู**: ุฎุทุฃ ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุฃุฌูุฒุฉ
**ุงูุฎุทุฃ:**
```
[ChangeProcessor] Document validation failed for replace in devices:
- Type mismatch for field "playstationRates": expected Map, got Object
- Required field missing: "hourlyRate"
```

**ุงูุญู:**
- ุชุบููุฑ ููุน `playstationRates` ูู `Map` ุฅูู `Object` ูู `server/models/Device.js`
- ุฅุถุงูุฉ validation ููุชุญูู ูู ุตุญุฉ ุงูุฃุณุนุงุฑ

### โ **ุงููุดููุฉ ุงูุซุงููุฉ**: ุฎุทุฃ ูู ุญุณุงุจ ุชูููุฉ ุงูุฌูุณุงุช
**ุงูุฎุทุฃ:**
```
TypeError: device.playstationRates.get is not a function
```

**ุงูุญู:**
- ุฅุตูุงุญ 3 ููุงุถุน ูู `server/models/Session.js`
- ุชุบููุฑ `device.playstationRates.get(String(controllers))` ุฅูู `device.playstationRates[String(controllers)]`

## ุงููููุงุช ุงูููุตูุญุฉ

### 1. `server/models/Device.js`
```javascript
playstationRates: {
    type: Object, // ุจุฏูุงู ูู Map
    required: function () {
        return this.type === "playstation";
    },
    validate: {
        validator: function(value) {
            if (this.type === "playstation" && value) {
                return Object.values(value).every(rate => 
                    typeof rate === 'number' && rate > 0
                );
            }
            return true;
        },
        message: 'ุฃุณุนุงุฑ ุงูุจูุงูุณุชูุดู ูุฌุจ ุฃู ุชููู ุฃุฑูุงู ููุฌุจุฉ'
    }
}
```

### 2. `server/models/Session.js`
**3 ููุงุถุน ุชู ุฅุตูุงุญูุง:**
- ุงูุณุทุฑ ~160: ูู ุฏุงูุฉ `calculateTotalCost`
- ุงูุณุทุฑ ~331: ูู ุฏุงูุฉ `calculateCurrentCost`  
- ุงูุณุทุฑ ~459: ูู ุฏุงูุฉ `getCostBreakdownAsync`

```javascript
// ูุจู ุงูุฅุตูุงุญ
return device.playstationRates.get(String(controllers)) || 0;

// ุจุนุฏ ุงูุฅุตูุงุญ
return device.playstationRates[String(controllers)] || 0;
```

## ุงูุงุฎุชุจุงุฑุงุช ุงูููุฌุชุงุฒุฉ

### 1. ุงุฎุชุจุงุฑ ูููุฐุฌ ุงูุฌูุงุฒ (`server/test-device-model.js`)
- โ ุฅูุดุงุก ุฌูุงุฒ ุจูุงูุณุชูุดู ุฌุฏูุฏ
- โ ุฅูุดุงุก ุฌูุงุฒ ููุจููุชุฑ ุฌุฏูุฏ
- โ ุชุญุฏูุซ ุฌูุงุฒ ููุฌูุฏ
- โ ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

### 2. ุงุฎุชุจุงุฑ ุญุณุงุจ ุชูููุฉ ุงูุฌูุณุงุช (`server/test-session-calculation.js`)
- โ ุญุณุงุจ ุงูุชูููุฉ ุงูุญุงููุฉ ููุฌูุณุงุช ุงููุดุทุฉ
- โ ุงููุตูู ูุฃุณุนุงุฑ ุงูุจูุงูุณุชูุดู ุญุณุจ ุนุฏุฏ ุงูุฏุฑุงุนุงุช
- โ ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ (5 ุฃุฌูุฒุฉ) ุจุดูู ุตุญูุญ

### 3. ูุญุต ุงูุฃุฌูุฒุฉ (`server/check-devices-simple.js`)
- โ ุฌููุน ุงูุฃุฌูุฒุฉ (5 ุฃุฌูุฒุฉ) ุณูููุฉ
- โ ูุง ุชูุฌุฏ ูุดุงูู ูู ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

## ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### โ **ุฌููุน ุงููุดุงูู ููุญูุฉ**
- ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุงูุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุฃุฌูุฒุฉ
- ุญุณุงุจ ุชูููุฉ ุงูุฌูุณุงุช ูุนูู ุจุดูู ุตุญูุญ
- ุฌููุน ุงูุฃุฌูุฒุฉ ุชุนูู ุจุฏูู ูุดุงูู
- ุงููุธุงู ุฌุงูุฒ ููุนูู ุจุดูู ูุงูู

### ๐ **ุงูุฅุญุตุงุฆูุงุช**
- **ุงูุฃุฌูุฒุฉ ุงูููุญูุตุฉ**: 5 ุฃุฌูุฒุฉ ุจูุงูุณุชูุดู
- **ุงููุดุงูู ุงูููุญูุฉ**: 2 ูุดุงูู ุฑุฆูุณูุฉ
- **ุงููููุงุช ุงูููุตูุญุฉ**: 2 ูููุงุช ุฃุณุงุณูุฉ
- **ุงูุงุฎุชุจุงุฑุงุช ุงูููุฌุชุงุฒุฉ**: 3 ุงุฎุชุจุงุฑุงุช ุดุงููุฉ

### ๐ฏ **ุงูุฃุณุนุงุฑ ุงููุทุจูุฉ**
- **1-2 ุฏุฑุงุนุงุช**: 20-25 ุฌููู/ุณุงุนุฉ
- **3 ุฏุฑุงุนุงุช**: 25-30 ุฌููู/ุณุงุนุฉ  
- **4 ุฏุฑุงุนุงุช**: 30-35 ุฌููู/ุณุงุนุฉ
- **ุงูููุจููุชุฑ**: 15 ุฌููู/ุณุงุนุฉ

## ุงูุฎูุงุตุฉ

ุชู ุฅุตูุงุญ ุฌููุน ูุดุงูู ุงูุฃุฌูุฒุฉ ูุงูุฌูุณุงุช ุจูุฌุงุญ. ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ูุณุชูุฑ ูููุซููุ ูุน ุฏุนู ูุงูู ูุญุณุงุจ ุชูููุฉ ุงูุฌูุณุงุช ูุฅุฏุงุฑุฉ ุงูุฃุฌูุฒุฉ ุจุฏูู ุฃุฎุทุงุก.