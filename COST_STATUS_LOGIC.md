# ููุทู ุญุงูุงุช ุงูุชูุงููู - Cost Status Logic

## ูุธุฑุฉ ุนุงูุฉ
ูุชู ุชุญุฏูุฏ ุญุงูุฉ ุงูุชูููุฉ ุชููุงุฆูุงู ุจูุงุกู ุนูู ุงููุจูุบ ุงููุฏููุน ูุชุงุฑูุฎ ุงูุงุณุชุญูุงู.

## ุงูุญุงูุงุช ุงููุชุงุญุฉ

### 1. **paid** (ูุฏููุน)
- **ุงูุดุฑุท**: `paidAmount >= amount`
- **ุงููุตู**: ุชู ุฏูุน ุงููุจูุบ ุจุงููุงูู
- **ุงูููู**: ุฃุฎุถุฑ ๐ข
- **ุงููุจูุบ ุงููุชุจูู**: 0

### 2. **overdue** (ูุชุฃุฎุฑ)
- **ุงูุดุฑุท**: `paidAmount < amount && dueDate < ุงูููู`
- **ุงููุตู**: ูู ูุชู ุงูุฏูุน ุจุงููุงูู ูุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- **ุงูููู**: ุฃุญูุฑ ๐ด
- **ุงููุจูุบ ุงููุชุจูู**: `amount - paidAmount`
- **ููุงุญุธุฉ**: ูุดูู ุงูุชูุงููู ุบูุฑ ุงููุฏููุนุฉ ูุงููุฏููุนุฉ ุฌุฒุฆูุงู

### 3. **partially_paid** (ูุฏููุน ุฌุฒุฆูุงู)
- **ุงูุดุฑุท**: `paidAmount > 0 && paidAmount < amount && (ูุง ููุฌุฏ dueDate ุฃู dueDate >= ุงูููู)`
- **ุงููุตู**: ุชู ุฏูุน ุฌุฒุก ูู ุงููุจูุบ ููู ูุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- **ุงูููู**: ุฃุฒุฑู ๐ต
- **ุงููุจูุบ ุงููุชุจูู**: `amount - paidAmount`

### 4. **pending** (ูุนูู)
- **ุงูุดุฑุท**: `paidAmount === 0 && (ูุง ููุฌุฏ dueDate ุฃู dueDate >= ุงูููู)`
- **ุงููุตู**: ูู ูุชู ุฏูุน ุฃู ุดูุก ููู ูุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- **ุงูููู**: ุฃุตูุฑ ๐ก
- **ุงููุจูุบ ุงููุชุจูู**: `amount`

### 5. **cancelled** (ููุบู)
- **ุงูุดุฑุท**: ูุชู ุชุนููููุง ูุฏููุงู
- **ุงููุตู**: ุชู ุฅูุบุงุก ุงูุชูููุฉ
- **ุงูููู**: ุฑูุงุฏู โช

## ุฃููููุฉ ุงูุชุญุฏูุฏ

ูุชู ุชุญุฏูุฏ ุงูุญุงูุฉ ุจุงูุชุฑุชูุจ ุงูุชุงูู:

```
1. ูู ุชู ุงูุฏูุน ุจุงููุงููุ
   โ ูุนู โ paid
   โ ูุง โ ุงูุชูู ููุฎุทูุฉ ุงูุชุงููุฉ

2. ูู ุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงูุ
   โ ูุนู โ overdue
   โ ูุง โ ุงูุชูู ููุฎุทูุฉ ุงูุชุงููุฉ

3. ูู ุชู ุฏูุน ุฌุฒุก ูู ุงููุจูุบุ
   โ ูุนู โ partially_paid
   โ ูุง โ pending
```

## ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุชูููุฉ ูุฏููุนุฉ ุจุงููุงูู
```javascript
{
  amount: 1000,
  paidAmount: 1000,
  dueDate: "2024-12-01",
  // ุงููุชูุฌุฉ: status = "paid"
}
```

### ูุซุงู 2: ุชูููุฉ ูุชุฃุฎุฑุฉ (ูู ููุฏูุน ุดูุก)
```javascript
{
  amount: 1000,
  paidAmount: 0,
  dueDate: "2024-11-01", // ุชุงุฑูุฎ ูุงุถู
  // ุงููุชูุฌุฉ: status = "overdue"
}
```

### ูุซุงู 3: ุชูููุฉ ูุชุฃุฎุฑุฉ (ูุฏููุนุฉ ุฌุฒุฆูุงู)
```javascript
{
  amount: 1000,
  paidAmount: 500,
  dueDate: "2024-11-01", // ุชุงุฑูุฎ ูุงุถู
  // ุงููุชูุฌุฉ: status = "overdue"
  // ุงููุจูุบ ุงููุชุจูู: 500
}
```

### ูุซุงู 4: ุชูููุฉ ูุฏููุนุฉ ุฌุฒุฆูุงู (ุบูุฑ ูุชุฃุฎุฑุฉ)
```javascript
{
  amount: 1000,
  paidAmount: 500,
  dueDate: "2024-12-31", // ุชุงุฑูุฎ ูุณุชูุจูู
  // ุงููุชูุฌุฉ: status = "partially_paid"
}
```

### ูุซุงู 5: ุชูููุฉ ูุนููุฉ
```javascript
{
  amount: 1000,
  paidAmount: 0,
  dueDate: "2024-12-31", // ุชุงุฑูุฎ ูุณุชูุจูู
  // ุงููุชูุฌุฉ: status = "pending"
}
```

### ูุซุงู 6: ุชูููุฉ ุจุฏูู ุชุงุฑูุฎ ุงุณุชุญูุงู
```javascript
{
  amount: 1000,
  paidAmount: 300,
  dueDate: null,
  // ุงููุชูุฌุฉ: status = "partially_paid"
}
```

## ุงูุชุญุฏูุซ ุงูุชููุงุฆู

ูุชู ุชุญุฏูุซ ุงูุญุงูุฉ ุชููุงุฆูุงู ูู ุงูุญุงูุงุช ุงูุชุงููุฉ:

### 1. ุนูุฏ ุฅูุดุงุก ุชูููุฉ ุฌุฏูุฏุฉ
```javascript
const cost = new Cost({
  amount: 1000,
  dueDate: "2024-12-31"
});
await cost.save(); // status = "pending"
```

### 2. ุนูุฏ ุฅุถุงูุฉ ุฏูุนุฉ
```javascript
await cost.addPayment(500, "cash");
// ูุชู ุชุญุฏูุซ: paidAmount, remainingAmount, status
```

### 3. ุนูุฏ ุฒูุงุฏุฉ ุงููุจูุบ
```javascript
await cost.increaseAmount(200);
// ูุชู ุฅุนุงุฏุฉ ุญุณุงุจ: remainingAmount, status
```

### 4. ุนูุฏ ุชุนุฏูู ุงูุชูููุฉ
```javascript
cost.amount = 1500;
await cost.save();
// ูุชู ุฅุนุงุฏุฉ ุญุณุงุจ: remainingAmount, status
```

## ุงูุฅุญุตุงุฆูุงุช ูู ุงููุงุฌูุฉ

### ูุฑูุช ุงูุฅุญุตุงุฆูุงุช:

1. **ุฅุฌูุงูู ุงูุชูุงููู**
   - `sum(cost.amount)` ูุฌููุน ุงูุชูุงููู

2. **ุงููุฏููุน**
   - `sum(cost.paidAmount)` ูุฌููุน ุงูุชูุงููู

3. **ุงููุชุจูู**
   - `sum(cost.remainingAmount)` ูุฌููุน ุงูุชูุงููู

4. **ุงููุชุฃุฎุฑ**
   - `sum(cost.remainingAmount)` ููุชูุงููู ุฐุงุช `status = "overdue"`
   - ูุดูู ุงูุชูุงููู ุบูุฑ ุงููุฏููุนุฉ ูุงููุฏููุนุฉ ุฌุฒุฆูุงู

## ููุงุญุธุงุช ูููุฉ

### 1. ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ุงุฎุชูุงุฑู
- ุฅุฐุง ูู ูุชู ุชุญุฏูุฏ `dueDate`ุ ูู ุชุตุจุญ ุงูุชูููุฉ ูุชุฃุฎุฑุฉ ุฃุจุฏุงู
- ุณุชุจูู `pending` ุฃู `partially_paid` ุญุณุจ ุงููุจูุบ ุงููุฏููุน

### 2. ุงูุฃููููุฉ ููุฏูุน ุงููุงูู
- ุญุชู ูู ุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงูุ ุฅุฐุง ุชู ุงูุฏูุน ุจุงููุงูู โ `paid`

### 3. ุงููุชุฃุฎุฑ ูุดูู ุงูุฌุฒุฆู
- ุงูุชูููุฉ ุงููุฏููุนุฉ ุฌุฒุฆูุงู ุชุตุจุญ ูุชุฃุฎุฑุฉ ุฅุฐุง ุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู
- ูุฐุง ููุทูู ูุฃู ุงููุจูุบ ุงููุชุจูู ูู ููุฏูุน ูู ุงูููุช ุงููุญุฏุฏ

### 4. ุงูุชุญุฏูุซ ุงูููุฑู
- ูุชู ุชุญุฏูุซ ุงูุญุงูุฉ ููุฑุงู ุนูุฏ ุฃู ุชุบููุฑ
- ูุง ุญุงุฌุฉ ูู cron job ุฃู scheduled task

## ุงูููุฏ ุงููุณุคูู

### ูู Model (`server/models/Cost.js`):
```javascript
costSchema.pre("save", function (next) {
    // ุญุณุงุจ ุงููุจูุบ ุงููุชุจูู
    this.remainingAmount = Math.max(0, this.amount - this.paidAmount);

    // ุชุญุฏูุฏ ุงูุญุงูุฉ
    if (this.paidAmount >= this.amount) {
        this.status = "paid";
    } else if (this.dueDate && this.dueDate < new Date()) {
        this.status = "overdue";
    } else if (this.paidAmount > 0) {
        this.status = "partially_paid";
    } else {
        this.status = "pending";
    }

    next();
});
```

### ูู Frontend (`src/pages/Costs.tsx`):
```javascript
const calculateStats = (costsData: Cost[]) => {
    const total = costsData.reduce((sum, cost) => sum + cost.amount, 0);
    const paid = costsData.reduce((sum, cost) => sum + cost.paidAmount, 0);
    const remaining = costsData.reduce((sum, cost) => sum + cost.remainingAmount, 0);
    const overdue = costsData
        .filter(c => c.status === 'overdue')
        .reduce((sum, cost) => sum + cost.remainingAmount, 0);

    setStats({ total, paid, remaining, overdue });
};
```

## ุงูุงุฎุชุจุงุฑ

### ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ:
1. โ ุฅูุดุงุก ุชูููุฉ ุฌุฏูุฏุฉ โ `pending`
2. โ ุฏูุน ุฌุฒุก ูู ุงููุจูุบ โ `partially_paid`
3. โ ุฏูุน ุงููุจูุบ ุจุงููุงูู โ `paid`
4. โ ุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ุจุฏูู ุฏูุน โ `overdue`
5. โ ุชุฌุงูุฒ ุชุงุฑูุฎ ุงูุงุณุชุญูุงู ูุน ุฏูุน ุฌุฒุฆู โ `overdue`
6. โ ุฒูุงุฏุฉ ุงููุจูุบ โ ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุญุงูุฉ
7. โ ุชูููุฉ ุจุฏูู ุชุงุฑูุฎ ุงุณุชุญูุงู โ ูุง ุชุตุจุญ ูุชุฃุฎุฑุฉ

## ุงูุฎูุงุตุฉ

ุงููุธุงู ุงูุขู ูุนูู ุจุดูู ุตุญูุญ:
- โ ุงูุชูุงููู ุงููุชุฃุฎุฑุฉ ุชุดูู ุบูุฑ ุงููุฏููุนุฉ ูุงููุฏููุนุฉ ุฌุฒุฆูุงู
- โ ุงูุฅุญุตุงุฆูุงุช ุฏูููุฉ ููุงุถุญุฉ
- โ ุงูุชุญุฏูุซ ุชููุงุฆู ุนูุฏ ุฃู ุชุบููุฑ
- โ ุงูููุทู ุจุณูุท ูุณูู ุงูููู
