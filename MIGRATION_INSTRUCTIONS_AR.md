# تعليمات تشغيل Migration للطاولات

## المشكلة
الطاولات تظهر "فاضية" رغم وجود طلبات عليها. السبب: الطلبات القديمة تستخدم `tableNumber` (رقم) بدلاً من `table` (ObjectId).

## الحل
يجب تشغيل migration script لتحويل البيانات القديمة إلى الصيغة الجديدة.

## الخطوات

### 1. افتح Terminal في مجلد server
```bash
cd server
```

### 2. شغل migration script
```bash
node scripts/migrateTableNumberToObjectId.js
```

### 3. انتظر حتى ينتهي
سيقوم Script بـ:
- ✅ البحث عن جميع الطلبات والفواتير التي تستخدم `tableNumber`
- ✅ تحويلها إلى `table` ObjectId
- ✅ عرض تقرير مفصل عن التغييرات

### 4. أعد تحميل صفحة Cafe
بعد انتهاء Migration، أعد تحميل الصفحة وستظهر الطاولات بحالتها الصحيحة!

## ملاحظات مهمة
- ✅ Script آمن ويمكن تشغيله عدة مرات
- ✅ يقوم بعمل backup قبل التعديل
- ✅ الكود الحالي يدعم البيانات القديمة والجديدة (backward compatible)
- ⚠️ لكن للحصول على أفضل أداء، يجب تشغيل Migration

## إذا واجهت مشاكل
1. تأكد من أن MongoDB يعمل
2. تأكد من أن ملف `.env` في مجلد server يحتوي على `MONGODB_URI` صحيح
3. شاهد console logs للتفاصيل
4. إذا فشل Migration، يمكنك استعادة Backup

## التحقق من نجاح Migration
بعد تشغيل Migration:
1. افتح صفحة Cafe
2. الطاولات التي عليها طلبات ستظهر "محجوزة" (لون أحمر)
3. الطاولات الفارغة ستظهر "فاضية" (لون أخضر)
