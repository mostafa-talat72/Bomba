# Requirements Document

## Introduction

يوجد خطأ في نظام الدفع الجزئي للأصناف حيث عند تحديد عدد معين من الأصناف للدفع، يقوم النظام بالدفع الكامل لجميع الأصناف بدلاً من دفع الكمية المحددة فقط. هذا الخطأ يؤثر على دقة الحسابات المالية ويسبب مشاكل في تتبع المدفوعات الجزئية.

## Glossary

- **النظام (System)**: نظام إدارة المقاهي والمطاعم Bomba
- **الفاتورة (Bill)**: وثيقة تحتوي على الطلبات والجلسات والمبالغ المستحقة
- **الصنف (Item)**: منتج أو خدمة في الطلب
- **الدفع الجزئي (Partial Payment)**: دفع جزء من المبلغ المستحق وليس كامل المبلغ
- **الكمية (Quantity)**: عدد الوحدات من الصنف
- **المستخدم (User)**: الشخص الذي يستخدم النظام (موظف أو كاشير)

## Requirements

### Requirement 1

**User Story:** كمستخدم للنظام، أريد أن أدفع لكمية محددة من صنف معين، حتى أتمكن من إدارة المدفوعات الجزئية بدقة

#### Acceptance Criteria

1. WHEN المستخدم يختار كمية محددة من صنف للدفع THEN النظام SHALL يحسب المبلغ بناءً على الكمية المحددة فقط
2. WHEN المستخدم يدفع لكمية جزئية من صنف THEN النظام SHALL يحدث الكمية المدفوعة والكمية المتبقية بشكل صحيح
3. WHEN المستخدم يدفع لكمية من صنف THEN النظام SHALL يسجل الكمية المدفوعة في سجل الدفعات
4. WHEN المستخدم يعرض الفاتورة THEN النظام SHALL يعرض الكمية المدفوعة والكمية المتبقية لكل صنف
5. WHEN المستخدم يدفع لكمية جزئية THEN النظام SHALL يمنع دفع نفس الكمية مرة أخرى

### Requirement 2

**User Story:** كمستخدم للنظام، أريد أن يتم حساب المبلغ المتبقي بدقة بعد الدفع الجزئي، حتى أتمكن من معرفة المبلغ المستحق بشكل صحيح

#### Acceptance Criteria

1. WHEN المستخدم يدفع لكمية جزئية من صنف THEN النظام SHALL يحسب المبلغ المتبقي بناءً على الكمية غير المدفوعة
2. WHEN المستخدم يدفع لعدة أصناف بكميات مختلفة THEN النظام SHALL يجمع المبالغ المدفوعة بشكل صحيح
3. WHEN جميع الكميات من جميع الأصناف مدفوعة THEN النظام SHALL يحدث حالة الفاتورة إلى "مدفوعة"
4. WHEN بعض الكميات من الأصناف مدفوعة THEN النظام SHALL يحدث حالة الفاتورة إلى "مدفوعة جزئياً"

### Requirement 3

**User Story:** كمطور للنظام، أريد أن يكون هيكل البيانات يدعم تتبع الكميات المدفوعة، حتى يتمكن النظام من إدارة الدفعات الجزئية بدقة

#### Acceptance Criteria

1. WHEN يتم إنشاء فاتورة جديدة THEN النظام SHALL يهيئ حقل الكمية المدفوعة لكل صنف بقيمة صفر
2. WHEN يتم دفع كمية من صنف THEN النظام SHALL يحدث حقل الكمية المدفوعة بالكمية الجديدة
3. WHEN يتم حساب المبلغ المتبقي THEN النظام SHALL يستخدم الكمية غير المدفوعة في الحساب
4. WHEN يتم عرض الفاتورة THEN النظام SHALL يعرض الكمية الأصلية والكمية المدفوعة والكمية المتبقية

### Requirement 4

**User Story:** كمستخدم للنظام، أريد أن يتم التحقق من صحة البيانات المدخلة، حتى لا يحدث أخطاء في الدفع

#### Acceptance Criteria

1. WHEN المستخدم يحاول دفع كمية أكبر من الكمية المتبقية THEN النظام SHALL يرفض العملية ويعرض رسالة خطأ
2. WHEN المستخدم يحاول دفع كمية صفر أو سالبة THEN النظام SHALL يرفض العملية ويعرض رسالة خطأ
3. WHEN المستخدم يحاول دفع لصنف مدفوع بالكامل THEN النظام SHALL يرفض العملية ويعرض رسالة خطأ
4. WHEN المستخدم يدخل بيانات صحيحة THEN النظام SHALL يقبل العملية ويعالج الدفع
