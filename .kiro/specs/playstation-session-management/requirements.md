# متطلبات نظام إدارة جلسات البلايستيشن المحسّن

## المقدمة

هذا المستند يحدد متطلبات تحسين نظام إدارة جلسات البلايستيشن في التطبيق، مع التركيز على إمكانية تعديل الجلسات النشطة، ربط الجلسات بالطاولات، وإدارة الفواتير بشكل احترافي. النظام يجب أن يدعم تعديل عدد الأذرع أثناء الجلسة النشطة، ربط الجلسات بالطاولات في أي وقت، وإدارة فواتير البلايستيشن بشكل منفصل عن فواتير الكافيه.

## المصطلحات

- **النظام**: تطبيق إدارة الكافيه والبلايستيشن
- **الجلسة النشطة**: جلسة بلايستيشن قيد التشغيل حالياً
- **الأذرع**: عدد أذرع التحكم (Controllers) المستخدمة في الجلسة
- **الفاتورة**: سجل مالي يحتوي على تفاصيل الطلبات أو الجلسات
- **الطاولة**: طاولة في الكافيه يمكن ربطها بجلسة بلايستيشن
- **المستخدم**: الموظف الذي يستخدم النظام
- **العميل**: الشخص الذي يستخدم جهاز البلايستيشن

## المتطلبات

### المتطلب 1: تعديل عدد الأذرع في الجلسة النشطة

**قصة المستخدم:** كموظف، أريد تعديل عدد الأذرع المستخدمة في جلسة بلايستيشن نشطة، حتى يتم حساب التكلفة بشكل دقيق بناءً على الأسعار المختلفة لكل عدد أذرع.

#### معايير القبول

1. WHEN المستخدم يختار تعديل عدد الأذرع لجلسة نشطة، THEN النظام SHALL يعرض واجهة لاختيار عدد الأذرع الجديد (1-4 أذرع)
2. WHEN المستخدم يؤكد تعديل عدد الأذرع، THEN النظام SHALL يحفظ التغيير مع تسجيل الوقت الذي تم فيه التعديل
3. WHEN يتم تعديل عدد الأذرع، THEN النظام SHALL يحسب التكلفة بناءً على الفترات الزمنية المختلفة وأسعار الأذرع المختلفة
4. WHEN يتم تعديل عدد الأذرع، THEN النظام SHALL يحدث الفاتورة المرتبطة بالجلسة تلقائياً
5. WHILE الجلسة نشطة، THE النظام SHALL يعرض عدد الأذرع الحالي والسعر الحالي للساعة

### المتطلب 2: ربط الجلسة بطاولة أثناء أو بعد التشغيل

**قصة المستخدم:** كموظف، أريد ربط جلسة البلايستيشن بطاولة في أي وقت (أثناء الجلسة أو عند الانتهاء)، حتى يتم دمج فاتورة البلايستيشن مع طلبات الطاولة.

#### معايير القبول

1. WHEN المستخدم يبدأ جلسة جديدة، THEN النظام SHALL يوفر خيار ربط الجلسة بطاولة أو تركها بدون طاولة
2. WHEN المستخدم يختار ربط الجلسة بطاولة، THEN النظام SHALL يعرض قائمة بالطاولات المتاحة
3. WHEN المستخدم يربط جلسة نشطة بطاولة، THEN النظام SHALL يدمج فاتورة الجلسة مع فاتورة الطاولة
4. WHEN المستخدم ينهي جلسة غير مرتبطة بطاولة، THEN النظام SHALL يطلب اسم العميل قبل إنهاء الجلسة
5. WHEN يتم ربط جلسة بطاولة، THEN النظام SHALL يحدث حالة الطاولة لتعكس وجود جلسة بلايستيشن نشطة

### المتطلب 2.1: فك ربط الجلسة من الطاولة (تحويل إلى بدون طاولة)

**قصة المستخدم:** كموظف، أريد فك ربط جلسة البلايستيشن من الطاولة وتحويلها إلى جلسة بدون طاولة، حتى يتم فصل فاتورة البلايستيشن عن فاتورة الطاولة ونقلها إلى قسم أجهزة البلايستيشن.

#### معايير القبول

1. WHEN المستخدم يختار فك ربط جلسة نشطة من طاولة، THEN النظام SHALL يعرض نافذة تأكيد توضح أن الفاتورة ستنفصل عن الطاولة
2. WHEN المستخدم يؤكد فك الربط، THEN النظام SHALL يفصل فاتورة الجلسة عن فاتورة الطاولة
3. WHEN يتم فك ربط الجلسة، THEN النظام SHALL ينقل الفاتورة من قسم الطاولات إلى قسم أجهزة البلايستيشن في صفحة الفواتير
4. WHEN يتم فك ربط الجلسة، THEN النظام SHALL يطلب اسم العميل إذا لم يكن موجوداً مسبقاً
5. WHEN يتم فك ربط الجلسة، THEN النظام SHALL يحدث حالة الطاولة لإزالة ارتباط جلسة البلايستيشن
6. WHEN يتم فك ربط الجلسة، THEN النظام SHALL يحتفظ بجميع بيانات الجلسة والتكلفة المحسوبة
7. WHEN يتم فك ربط الجلسة، THEN النظام SHALL يحدث نوع الفاتورة من "cafe" إلى "playstation"

### المتطلب 3: عرض أجهزة البلايستيشن في صفحة الفواتير

**قصة المستخدم:** كموظف، أريد رؤية أجهزة البلايستيشن النشطة في صفحة الفواتير، حتى أتمكن من متابعة جميع الفواتير من مكان واحد.

#### معايير القبول

1. WHEN المستخدم يفتح صفحة الفواتير، THEN النظام SHALL يعرض قسماً منفصلاً لفواتير البلايستيشن
2. WHEN جهاز بلايستيشن يحتوي على جلسة نشطة، THEN النظام SHALL يعرض الجهاز في صفحة الفواتير مع حالة "نشط"
3. WHEN جهاز بلايستيشن مرتبط بطاولة، THEN النظام SHALL يعرض رقم الطاولة بجانب اسم الجهاز
4. WHEN جهاز بلايستيشن غير مرتبط بطاولة، THEN النظام SHALL يعرض اسم العميل إذا كان متوفراً
5. THE النظام SHALL يحدث عرض الفواتير تلقائياً عند حدوث تغييرات في الجلسات

### المتطلب 4: إدارة فواتير البلايستيشن المستقلة

**قصة المستخدم:** كموظف، أريد إدارة فواتير البلايستيشن غير المرتبطة بطاولات بشكل منفصل، حتى أتمكن من تتبع إيرادات البلايستيشن بدقة.

#### معايير القبول

1. WHEN يتم إنشاء جلسة بلايستيشن بدون طاولة، THEN النظام SHALL يُنشئ فاتورة من نوع "playstation"
2. WHEN يتم إنهاء جلسة بلايستيشن بدون طاولة، THEN النظام SHALL يطلب اسم العميل ويحفظه في الفاتورة
3. WHEN المستخدم يعرض الفواتير، THEN النظام SHALL يفصل فواتير البلايستيشن عن فواتير الكافيه
4. WHEN يتم دفع فاتورة بلايستيشن، THEN النظام SHALL يسجل الدفع ويحدث حالة الفاتورة
5. THE النظام SHALL يحسب إجمالي إيرادات البلايستيشن بشكل منفصل في التقارير

### المتطلب 5: الحفاظ على البيانات عند إعادة التحميل

**قصة المستخدم:** كموظف، أريد أن تبقى جميع بيانات الجلسات والفواتير محفوظة عند إعادة تحميل الصفحة، حتى لا أفقد أي معلومات مهمة.

#### معايير القبول

1. WHEN المستخدم يعيد تحميل الصفحة، THEN النظام SHALL يستعيد جميع الجلسات النشطة من قاعدة البيانات
2. WHEN المستخدم يعيد تحميل الصفحة، THEN النظام SHALL يستعيد جميع الفواتير المفتوحة
3. WHEN المستخدم يعيد تحميل الصفحة، THEN النظام SHALL يحدث حسابات الوقت والتكلفة للجلسات النشطة
4. WHEN يحدث انقطاع في الاتصال، THEN النظام SHALL يعرض رسالة خطأ واضحة ويحاول إعادة الاتصال
5. THE النظام SHALL يحفظ جميع التغييرات في قاعدة البيانات فوراً

### المتطلب 6: حساب التكلفة الديناميكي

**قصة المستخدم:** كموظف، أريد أن يحسب النظام تكلفة الجلسة بدقة بناءً على الوقت وعدد الأذرع المستخدمة، حتى تكون الفواتير دقيقة.

#### معايير القبول

1. WHEN يتم تعديل عدد الأذرع في جلسة نشطة، THEN النظام SHALL يحسب التكلفة لكل فترة زمنية بناءً على عدد الأذرع المستخدم فيها
2. WHEN تستمر الجلسة، THEN النظام SHALL يحدث التكلفة الإجمالية كل دقيقة
3. WHEN يتم إنهاء الجلسة، THEN النظام SHALL يحسب التكلفة النهائية بدقة بناءً على جميع الفترات الزمنية
4. WHEN يتم عرض الجلسة النشطة، THEN النظام SHALL يعرض التكلفة الحالية والوقت المنقضي
5. THE النظام SHALL يحفظ سجل تغييرات عدد الأذرع مع الأوقات في قاعدة البيانات

### المتطلب 7: واجهة مستخدم احترافية

**قصة المستخدم:** كموظف، أريد واجهة مستخدم سهلة وواضحة لإدارة جلسات البلايستيشن، حتى أتمكن من العمل بكفاءة.

#### معايير القبول

1. WHEN المستخدم يعرض صفحة البلايستيشن، THEN النظام SHALL يعرض جميع الأجهزة مع حالتها الحالية بوضوح
2. WHEN المستخدم يتفاعل مع جلسة، THEN النظام SHALL يعرض رسائل تأكيد واضحة قبل العمليات المهمة
3. WHEN يحدث خطأ، THEN النظام SHALL يعرض رسالة خطأ واضحة ومفيدة
4. WHEN المستخدم ينفذ عملية، THEN النظام SHALL يعرض مؤشر تحميل أثناء معالجة العملية
5. THE النظام SHALL يستخدم ألوان وأيقونات واضحة للتمييز بين الحالات المختلفة
