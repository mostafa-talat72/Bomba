# โ ุฅุตูุงุญ: ุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู ูุน ุงูุฌูุณุงุช

## ุงููุดููุฉ
ุนูุฏ ุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู ููุงูุช ุชุญุชูู ุนูู ุฌูุณุงุชุ ูุงูุช ุงููุงุชูุฑุฉ ุชุชุญูู ุฅูู "ุฏูุน ุฌุฒุฆู" ุจุฏูุงู ูู "ูุฏููุนุฉ"ุ ุฅูุง ุฅุฐุง ุชู ุฏูุน ุงูุฌูุณุงุช ูุฏููุงู.

## ุงูุณุจุจ
ุงูููุฏ ูุงู ูุชุญูู ูู ูุฌูุฏ ุฌูุณุงุช ุบูุฑ ูุฏููุนุฉ ุจุงููุงููุ ูุฅุฐุง ููุฌุฏุชุ ูุถุน ุญุงูุฉ ุงููุงุชูุฑุฉ "ุฌุฒุฆูุฉ" ุญุชู ูู ุชู ุฏูุน ุงููุจูุบ ุงููุงูู.

## ุงูุญู ุงููุทุจู

### ูู Backend (billingController.js)

ุนูุฏ ุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู (`status === 'paid'`)ุ ูุชู ุงูุขู:

1. **ุฏูุน ุฌููุน ุงูุฃุตูุงู ุชููุงุฆูุงู**
2. **ุฏูุน ุฌููุน ุงูุฌูุณุงุช ุชููุงุฆูุงู**

```javascript
// Mark all sessions as paid if bill is fully paid
if (status === 'paid' && bill.sessionPayments && bill.sessionPayments.length > 0) {
    let sessionsUpdated = false;
    bill.sessionPayments.forEach(sessionPayment => {
        const remainingAmount = sessionPayment.remainingAmount || 0;
        if (remainingAmount > 0) {
            // ุฏูุน ุงููุจูุบ ุงููุชุจูู ููุฌูุณุฉ
            if (!sessionPayment.payments) {
                sessionPayment.payments = [];
            }
            sessionPayment.payments.push({
                amount: remainingAmount,
                method: method || 'cash',
                paidBy: req.user._id,
                paidAt: new Date(),
                reference: reference || null
            });
            sessionPayment.paidAmount = (sessionPayment.paidAmount || 0) + remainingAmount;
            sessionPayment.remainingAmount = 0;
            sessionPayment.isPaid = true;
            sessionsUpdated = true;
        }
    });
    if (sessionsUpdated) {
        await bill.save();
    }
}
```

### ูู Frontend (Billing.tsx)

ุชู ุฅุฒุงูุฉ ุงุณุชุฏุนุงุก `updateBillStatus` ุจุนุฏ ุงูุฏูุน ูุฃู Backend ูุชููู ุชุญุฏูุฏ ุงูุญุงูุฉ ุงูุตุญูุญุฉ:

```typescript
// ูุง ูุณุชุฏุนู updateBillStatus ููุง ูุฃู ุงูู Backend ูุชููู ุฐูู
// ูุงูุงุณุชุฏุนุงุก ููุง ูุฏ ููุนูุฏ ุญุณุงุจ ุงูุญุงูุฉ ุจุดูู ุฎุงุทุฆ
```

## ุงูุณููู ุงูุฌุฏูุฏ

### ูุจู ุงูุฅุตูุงุญ โ
1. ุงููุณุชุฎุฏู ูุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู
2. ุงููุชุจูู ูุตุจุญ 0
3. ุงููุงุชูุฑุฉ ุชุชุญูู ุฅูู "ุฏูุน ุฌุฒุฆู" (ูุฃู ุงูุฌูุณุงุช ูู ุชูุฏูุน)
4. ุงููุณุชุฎุฏู ูุญุชุงุฌ ูุฏูุน ุงูุฌูุณุงุช ูุฏููุงู
5. ุจุนุฏ ุฏูุน ุงูุฌูุณุงุชุ ุงููุงุชูุฑุฉ ุชุชุญูู ุฅูู "ูุฏููุนุฉ"

### ุจุนุฏ ุงูุฅุตูุงุญ โ
1. ุงููุณุชุฎุฏู ูุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู
2. ุงููุชุจูู ูุตุจุญ 0
3. **ุฌููุน ุงูุฌูุณุงุช ุชูุฏูุน ุชููุงุฆูุงู**
4. **ุงููุงุชูุฑุฉ ุชุชุญูู ุฅูู "ูุฏููุนุฉ" ูุจุงุดุฑุฉ**

## ุงููููุงุช ุงููุนุฏูุฉ

- `server/controllers/billingController.js` - ุฅุถุงูุฉ ุฏูุน ุงูุฌูุณุงุช ุชููุงุฆูุงู
- `src/pages/Billing.tsx` - ุฅุฒุงูุฉ ุงุณุชุฏุนุงุก updateBillStatus

## ุงูุงุฎุชุจุงุฑ

1. โ ุฃูุดุฆ ูุงุชูุฑุฉ ุชุญุชูู ุนูู ุทูุจุงุช ูุฌูุณุฉ PlayStation
2. โ ุงุถุบุท "ุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู"
3. โ ุชุญูู: ูู ุงููุชุจูู = 0ุ
4. โ ุชุญูู: ูู ุงููุงุชูุฑุฉ ุฃุตุจุญุช "ูุฏููุนุฉ"ุ
5. โ ุชุญูู: ูู ุงูุฌูุณุงุช ูุฏููุนุฉ ุจุงููุงููุ

## ุงููุชูุฌุฉ

โ **ุฏูุน ุงููุงุชูุฑุฉ ุจุงููุงูู ูุฏูุน ูู ุดูุก ุชููุงุฆูุงู**
โ **ุงููุงุชูุฑุฉ ุชุชุญูู ุฅูู "ูุฏููุนุฉ" ูุจุงุดุฑุฉ**
โ **ูุง ุญุงุฌุฉ ูุฏูุน ุงูุฌูุณุงุช ูุฏููุงู**

---

**ุชู ุงูุฅุตูุงุญ ุจูุฌุงุญ! ๐ฐ**
