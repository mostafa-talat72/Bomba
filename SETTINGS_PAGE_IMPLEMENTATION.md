# صفحة الإعدادات - التوثيق

## نظرة عامة
تم إنشاء صفحة إعدادات متواضعة وبسيطة مع إمكانية تغيير كلمة المرور وإعدادات الإشعارات. الصفحة مقسمة إلى أربعة أقسام رئيسية:

### 1. الملف الشخصي
- ✅ تحديث الاسم والبريد الإلكتروني والهاتف والعنوان
- ✅ التحقق من صحة البيانات
- ✅ حفظ فوري للتغييرات

### 2. تغيير كلمة المرور
- ✅ التحقق من كلمة المرور الحالية
- ✅ إدخال كلمة المرور الجديدة مع التأكيد
- ✅ إظهار/إخفاء كلمة المرور (أيقونة العين)
- ✅ التحقق من قوة كلمة المرور (6 أحرف على الأقل)

### 3. إعدادات الإشعارات
- ✅ إشعارات الجلسات
- ✅ إشعارات الطلبات
- ✅ إشعارات المخزون
- ✅ إشعارات الفواتير
- ✅ تفعيل/إلغاء صوت الإشعارات
- ✅ إشعارات البريد الإلكتروني
- ✅ إظهار عدد الإشعارات
- ✅ تحديد كمقروء تلقائياً

### 4. الإعدادات العامة
- ✅ اختيار المظهر (فاتح/داكن/تلقائي)
- ✅ اختيار اللغة (العربية/الإنجليزية)
- ✅ اختيار المنطقة الزمنية
- ✅ اختيار العملة

## الملفات المحدثة

### Frontend
1. **`src/pages/Settings.tsx`**
   - صفحة الإعدادات الجديدة مع واجهة مستخدم متواضعة
   - أربعة أقسام رئيسية مع تبويبات
   - التحقق من صحة البيانات
   - إظهار/إخفاء كلمات المرور

2. **`src/services/api.ts`**
   - إضافة دوال API جديدة:
     - `updateUserProfile()` - تحديث الملف الشخصي
     - `changePassword()` - تغيير كلمة المرور
     - `updateNotificationSettings()` - تحديث إعدادات الإشعارات
     - `updateGeneralSettings()` - تحديث الإعدادات العامة

3. **`src/context/AppContext.tsx`**
   - إضافة دوال جديدة في AppContext:
     - `updateUserProfile()`
     - `changePassword()`
     - `updateNotificationSettings()`
     - `updateGeneralSettings()`

### Backend
1. **`server/controllers/settingsController.js`**
   - تحسين controller الإعدادات
   - إضافة دعم لتحديث الملف الشخصي
   - إضافة دعم لتغيير كلمة المرور
   - إضافة دعم لإعدادات الإشعارات والإعدادات العامة

2. **`server/routes/settingsRoutes.js`**
   - تحديث routes للإعدادات
   - إضافة routes جديدة للملف الشخصي وكلمة المرور

## الميزات التقنية

### الأمان
- ✅ التحقق من كلمة المرور الحالية قبل التغيير
- ✅ تشفير كلمة المرور الجديدة
- ✅ التحقق من صحة البيانات المدخلة
- ✅ حماية من XSS و CSRF

### واجهة المستخدم
- ✅ تصميم متواضع وبسيط
- ✅ تبويبات واضحة ومنظمة
- ✅ رسائل خطأ ونجاح واضحة
- ✅ تحميل أثناء الحفظ
- ✅ إظهار/إخفاء كلمات المرور

### الأداء
- ✅ تحميل سريع للصفحة
- ✅ حفظ فوري للتغييرات
- ✅ معالجة الأخطاء بشكل صحيح
- ✅ تحديث البيانات في الوقت الفعلي

## كيفية الاستخدام

### 1. الوصول للصفحة
```
http://localhost:3000/settings
```

### 2. تحديث الملف الشخصي
1. انتقل لتبويب "الملف الشخصي"
2. عدل البيانات المطلوبة
3. اضغط "حفظ التغييرات"

### 3. تغيير كلمة المرور
1. انتقل لتبويب "كلمة المرور"
2. أدخل كلمة المرور الحالية
3. أدخل كلمة المرور الجديدة وتأكيدها
4. اضغط "تغيير كلمة المرور"

### 4. إعدادات الإشعارات
1. انتقل لتبويب "الإشعارات"
2. عدل الإعدادات المطلوبة
3. اضغط "حفظ إعدادات الإشعارات"

### 5. الإعدادات العامة
1. انتقل لتبويب "عام"
2. عدل الإعدادات المطلوبة
3. اضغط "حفظ الإعدادات العامة"

## API Endpoints

### الملف الشخصي
- `GET /api/settings/profile` - جلب الملف الشخصي
- `PUT /api/settings/profile` - تحديث الملف الشخصي

### كلمة المرور
- `PUT /api/settings/change-password` - تغيير كلمة المرور

### إعدادات الإشعارات
- `GET /api/settings/notifications` - جلب إعدادات الإشعارات
- `PUT /api/settings/notifications` - تحديث إعدادات الإشعارات

### الإعدادات العامة
- `GET /api/settings/general` - جلب الإعدادات العامة
- `PUT /api/settings/general` - تحديث الإعدادات العامة

## ملاحظات تقنية

### التحقق من صحة البيانات
- الاسم والبريد الإلكتروني مطلوبان
- كلمة المرور يجب أن تكون 6 أحرف على الأقل
- البريد الإلكتروني يجب أن يكون صحيحاً

### معالجة الأخطاء
- رسائل خطأ واضحة باللغة العربية
- معالجة أخطاء الشبكة
- معالجة أخطاء الخادم

### الأمان
- التحقق من التوكن في كل طلب
- تشفير كلمة المرور
- حماية من الهجمات الشائعة

## التطوير المستقبلي

### ميزات مقترحة
- [ ] إعدادات متقدمة للمظهر
- [ ] إعدادات الأمان (مثل تفعيل المصادقة الثنائية)
- [ ] إعدادات النسخ الاحتياطي
- [ ] إعدادات الإشعارات المتقدمة
- [ ] إعدادات الأداء

### تحسينات مقترحة
- [ ] حفظ الإعدادات تلقائياً
- [ ] استعادة الإعدادات الافتراضية
- [ ] تصدير/استيراد الإعدادات
- [ ] إعدادات خاصة بكل مستخدم

## الخلاصة

تم إنشاء صفحة إعدادات متواضعة ومفيدة تتيح للمستخدمين:
- تحديث بياناتهم الشخصية
- تغيير كلمة المرور بأمان
- تخصيص إعدادات الإشعارات
- تعديل الإعدادات العامة

الصفحة مصممة لتكون سهلة الاستخدام ومفيدة مع الحفاظ على الأمان والأداء.
