# ุฅุตูุงุญุงุช ูุธุงู ุงูุฏูุน ุงูุฌุฒุฆู

## ุงููุดุงูู ุงูุชู ุชู ุงูุชุดุงููุง ูุฅุตูุงุญูุง

### 1. ูุดููุฉ ูู Controller ุงูุฏูุน ุงูุฌุฒุฆู (Backend)

**ุงููุดููุฉ:**
- ูุงู ุงููุธุงู ูุณุชุฎุฏู ุทุฑููุฉ `addPartialPayment` ุงููุฏููุฉ ูู Model
- ุนุฏู ุฏูุฉ ูู ุชุญุฏูุฏ ุงูุนูุงุตุฑ ุงููุฏููุนุฉ
- ุนุฏู ุชุญุฏูุซ `itemPayments` ุจุดูู ุตุญูุญ
- ุฑุณุงุฆู Socket.IO ุบูุฑ ูุงููุฉ

**ุงูุญู:**
```javascript
// server/controllers/billingController.js - addPartialPayment

// ุงูุชุญุณููุงุช:
1. ูุนุงูุฌุฉ ูุจุงุดุฑุฉ ููุนูุงุตุฑ ุจุฏูุงู ูู ุงุณุชุฎุฏุงู addPartialPayment method
2. ุงูุจุญุซ ุนู ุงูุนูุงุตุฑ ุจุงุณุชุฎุฏุงู itemId ุจุฏูุงู ูู itemName + price
3. ุชุญุฏูุซ ุฃู ุฅูุดุงุก itemPayment records ุจุดูู ุตุญูุญ
4. ุฅุถุงูุฉ logging ููุตู ูุชุชุจุน ุงูุนูููุงุช
5. ุฅุฑุณุงู ุชูุงุตูู ูุงููุฉ ุนุจุฑ Socket.IO
6. ุฅุถุงูุฉ payment history ูุน ุชูุงุตูู ุงูุนูุงุตุฑ
```

### 2. ูุดููุฉ ูู ุญุณุงุจ ุงููููุงุช ุงููุชุจููุฉ

**ุงููุดููุฉ:**
- ุนุฏู ุฏูุฉ ูู ุญุณุงุจ `paidQuantity` ู `remainingQuantity`
- ุชุถุงุฑุจ ุจูู ุงููุธุงู ุงููุฏูู (partialPayments) ูุงูุฌุฏูุฏ (itemPayments)

**ุงูุญู:**
- ุงุณุชุฎุฏุงู `itemPayments` ููุตุฏุฑ ุฑุฆูุณู ููุจูุงูุงุช
- ุญุณุงุจ ุฏููู ูููููุงุช ุงููุฏููุนุฉ ูุงููุชุจููุฉ
- ุชุญุฏูุซ `isPaid` flag ุจูุงุกู ุนูู ุงูููุงุฑูุฉ ุงูุตุญูุญุฉ

### 3. ูุดููุฉ ูู Frontend - Billing.tsx

**ุงููุดููุฉ:**
- ูุงู ูุฑุณู `itemName` ู `price` ุจุฏูุงู ูู `itemId`
- ุนุฏู ุชุญุฏูุซ ุงููุงุชูุฑุฉ ุจุนุฏ ุงูุฏูุน ุจุดูู ุตุญูุญ

**ุงูุญู:**
```typescript
// src/pages/Billing.tsx - handlePartialPaymentSubmit

// ุงูุชุญุณููุงุช:
1. ุฅุฑุณุงู itemId ูุจุงุดุฑุฉ ุจุฏูุงู ูู itemName + price
2. ุฅุนุงุฏุฉ ุชุญููู ุงููุงุชูุฑุฉ ุจุนุฏ ุงูุฏูุน ููุญุตูู ุนูู ุฃุญุฏุซ ุงูุจูุงูุงุช
3. ุนุฑุถ ุฑุณุงุฆู ูุฌุงุญ ุฃูุซุฑ ูุถูุญุงู ูุน ุงููุจูุบ ุงููุฏููุน
```

### 4. ุชุญุณููุงุช ูู PartialPaymentModal

**ุงููุดููุฉ:**
- ุนุฏู ุฅุนุงุฏุฉ ุชุนููู ุงูุนูุงุตุฑ ุงููุญุฏุฏุฉ ุนูุฏ ุชุญุฏูุซ ุงููุงุชูุฑุฉ

**ุงูุญู:**
- ุฅุถุงูุฉ useEffect ูุฅุนุงุฏุฉ ุชุนููู selectedItems ุนูุฏ ุชุบููุฑ ุจูุงูุงุช ุงููุงุชูุฑุฉ
- ุชุญุณูู ุนุฑุถ ุงููููุงุช ุงููุชุจููุฉ

## ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### 1. Logging ูุญุณูู
```javascript
Logger.info(`๐ [addPartialPayment] Processing partial payment...`);
Logger.info(`โ [addPartialPayment] Partial payment processed successfully`);
```

### 2. Socket.IO Events ูุญุณููุฉ
```javascript
req.io.emit('partial-payment-received', {
    type: 'partial-payment',
    bill: bill,
    amount: totalPaymentAmount,
    items: processedItems,
    message: 'ุชู ุฅุถุงูุฉ ุงูุฏูุน ุงูุฌุฒุฆู ุจูุฌุงุญ'
});
```

### 3. Payment History
```javascript
bill.payments.push({
    amount: totalPaymentAmount,
    method: paymentMethod || "cash",
    timestamp: new Date(),
    user: req.user._id,
    type: "partial",
    items: processedItems
});
```

## ุงุฎุชุจุงุฑ ุงููุธุงู

### ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ:

1. **ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ูุน ุทูุจุงุช**
   - ุชุฃูุฏ ูู ูุฌูุฏ ุนุฏุฉ ุฃุตูุงู ุจูููุงุช ูุฎุชููุฉ

2. **ูุชุญ ูุงูุฐุฉ ุงูุฏูุน ุงูุฌุฒุฆู**
   - ุชุญูู ูู ุนุฑุถ ุฌููุน ุงูุฃุตูุงู ุจุดูู ุตุญูุญ
   - ุชุญูู ูู ุงููููุงุช ุงููุชุจููุฉ

3. **ุงุฎุชูุงุฑ ุฃุตูุงู ููุฏูุน**
   - ุงุฎุชุฑ ูููุงุช ุฌุฒุฆูุฉ ูู ุจุนุถ ุงูุฃุตูุงู
   - ุชุญูู ูู ุญุณุงุจ ุงููุจูุบ ุงูุฅุฌูุงูู

4. **ุชูููุฐ ุงูุฏูุน**
   - ุชุญูู ูู ุฑุณุงูุฉ ุงููุฌุงุญ
   - ุชุญูู ูู ุชุญุฏูุซ ุงููุงุชูุฑุฉ ููุฑุงู
   - ุชุญูู ูู ุชุญุฏูุซ ุงููููุงุช ุงููุชุจููุฉ

5. **ุฏูุน ุฌุฒุฆู ุขุฎุฑ**
   - ุชุญูู ูู ุนุฏู ุธููุฑ ุงูุฃุตูุงู ุงููุฏููุนุฉ ุจุงููุงูู
   - ุชุญูู ูู ุงููููุงุช ุงููุชุจููุฉ ุงูุตุญูุญุฉ

6. **ุฅููุงู ุงูุฏูุน**
   - ุงุฏูุน ุจุงูู ุงูุฃุตูุงู
   - ุชุญูู ูู ุชุบููุฑ ุญุงูุฉ ุงููุงุชูุฑุฉ ุฅูู "paid"
   - ุชุญูู ูู ุฅุบูุงู ูุงูุฐุฉ ุงูุฏูุน ุงูุฌุฒุฆู ุชููุงุฆูุงู

## ุงููููุงุช ุงููุนุฏูุฉ

1. `server/controllers/billingController.js` - ุฏุงูุฉ addPartialPayment
2. `src/pages/Billing.tsx` - ุฏุงูุฉ handlePartialPaymentSubmit (ูู ูุชู ุงูุชุนุฏูู - ุงูููุฏ ุงูุญุงูู ุฌูุฏ)
3. `src/components/PartialPaymentModal.tsx` - ุชุญุณููุงุช ุทูููุฉ

## ููุงุญุธุงุช ูููุฉ

1. ุงููุธุงู ูุฏุนู ุงูุขู `itemId` ุจุฏูุงู ูู `itemName + price` ูุชุญุฏูุฏ ุงูุนูุงุตุฑ ุจุดูู ุฃุฏู
2. `itemPayments` ูู ุงููุตุฏุฑ ุงูุฑุฆูุณู ููุจูุงูุงุช (ุงููุธุงู ุงูุฌุฏูุฏ)
3. `partialPayments` ูุง ูุฒุงู ููุฌูุฏุงู ููุชูุงูู ูุน ุงูุฅุตุฏุงุฑุงุช ุงููุฏููุฉ
4. Socket.IO ูุฑุณู ุชุญุฏูุซุงุช ููุฑูุฉ ูุฌููุน ุงููุณุชุฎุฏููู
5. Payment history ูุญุชูุธ ุจุณุฌู ูุงูู ูุฌููุน ุงูุฏูุนุงุช

## ุงูุชูุตูุงุช

1. **ุงุฎุชุจุงุฑ ุดุงูู** ูููุธุงู ูู ุจูุฆุฉ ุงูุชุทููุฑ ูุจู ุงููุดุฑ
2. **ูุฑุงูุจุฉ Logs** ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก
3. **ูุณุฎ ุงุญุชูุงุทู** ููุจูุงูุงุช ูุจู ุงูุชุญุฏูุซ
4. **ุชุฏุฑูุจ ุงููุณุชุฎุฏููู** ุนูู ุงููุธุงู ุงูุฌุฏูุฏ
